<odoo>

    <!-- 1️⃣ Definir primero la acción -->
    <record id="action_account_template_export_wizard" model="ir.actions.act_window">
        <field name="name">Exportar plantilla Excel (MIS)</field>
        <field name="res_model">account.template.export.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <!-- 2️⃣ Luego los menús -->
    <menuitem id="menu_account_reporting_root"
              name="Informes Personalizados"
              parent="account.menu_finance"
              sequence="100"/>

    <menuitem id="menu_account_template_export"
              name="Exportar plantilla .xlsm (MIS)"
              parent="menu_account_reporting_root"
              action="action_account_template_export_wizard"/>

    <!-- 3️⃣ Las vistas del wizard -->
    <record id="view_account_template_export_wizard" model="ir.ui.view">
        <field name="name">account.template.export.wizard.form</field>
        <field name="model">account.template.export.wizard</field>
        <field name="arch" type="xml">
            <form string="Exportar plantilla XLSM desde informe MIS">
                <group>
                    <field name="company_id"/>
                    <field name="mis_instance_id"/>
                    <field name="template_id"/>
                </group>
                <footer>
                    <button string="Generar y descargar" type="object" name="action_generate" class="btn-primary"/>
                    <button string="Cancelar" special="cancel" class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- 4️⃣ Vistas de las plantillas Excel -->
    <record id="view_account_excel_template_tree" model="ir.ui.view">
        <field name="name">account.excel.template.tree</field>
        <field name="model">account.excel.template</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="filename"/>
            </tree>
        </field>
    </record>

    <record id="view_account_excel_template_form" model="ir.ui.view">
        <field name="name">account.excel.template.form</field>
        <field name="model">account.excel.template</field>
        <field name="arch" type="xml">
            <form string="Plantilla Excel">
                <group>
                    <field name="name"/>
                    <field name="file" filename="filename"/>
                </group>
            </form>
        </field>
    </record>

</odoo>

